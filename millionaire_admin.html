<!DOCTYPE html>
<html>
<head>
    <title>ADMIN PANEL | Millionaires Club</title>
    <style>
        body { background: #0B0E11; color: #fff; font-family: sans-serif; padding: 30px; display: none; }
        .order-card { background: #1E2329; border-radius: 12px; padding: 25px; margin-bottom: 20px; border-left: 10px solid #FCD535; }
        .info { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #333; padding-bottom: 10px; margin-bottom: 15px; }
        input { padding: 12px; width: 280px; background: #0B0E11; border: 1px solid #444; color: #fff; border-radius: 5px; margin-right: 10px; }
        .btn-live { background: #2ebd85; color: #fff; border: none; padding: 12px 25px; border-radius: 5px; cursor: pointer; font-weight: bold; }
        .btn-delete { background: #f6465d; color: #fff; border: none; padding: 12px 25px; border-radius: 5px; cursor: pointer; margin-left: 10px; }
    </style>
</head>
<body>
    <script>
        if(prompt("Access Password:") !== "KAWSARahmed22@@") { window.location.href="index.html"; } 
        else { document.body.style.display="block"; }
    </script>

    <h1 style="color:#FCD535;">PENDING ORDERS</h1>
    <div id="list">লোড হচ্ছে...</div>

    <script type="module">
        import { db, ref, onValue } from "./millionaire_firebase-config.js";
        import { set, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        onValue(ref(db, 'pending_orders/Millionaire'), s => {
            const data = s.val();
            const container = document.getElementById('list');
            container.innerHTML = "";
            if(!data) { container.innerHTML = "কোন পেন্ডিং অর্ডার নেই।"; return; }

            Object.keys(data).forEach(id => {
                const o = data[id];
                container.innerHTML += `
                    <div class="order-card">
                        <div class="info">
                            <span><b>PLOT #${o.plotID}</b> - ${o.brandName} (WhatsApp: ${o.whatsapp})</span>
                            <small>${new Date(o.timestamp).toLocaleString()}</small>
                        </div>
                        <input type="text" id="img_${id}" placeholder="Logo Link (Direct PNG)">
                        <input type="text" id="url_${id}" placeholder="Website URL">
                        <button class="btn-live" onclick="goLive('${id}', ${o.plotID}, '${o.brandName}')">APPROVE & LIVE</button>
                        <button class="btn-delete" onclick="delOrder('${id}')">REJECT</button>
                    </div>`;
            });
        });

        window.goLive = (id, pid, name) => {
            const img = document.getElementById('img_'+id).value;
            const web = document.getElementById('url_'+id).value;
            if(!img) return alert("লোগো লিঙ্ক দিন!");

            set(ref(db, 'estate_data/Millionaire/' + pid), {
                name, imageUrl: img, link: web || "#", plotID: pid, status: "SOLD"
            }).then(() => {
                remove(ref(db, 'pending_orders/Millionaire/' + id));
                alert("প্লটটি এখন লাইভ!");
            });
        };

        window.delOrder = (id) => { if(confirm("ডিলিট করবেন?")) remove(ref(db, 'pending_orders/Millionaire/' + id)); };
    </script>
</body>
</html>
