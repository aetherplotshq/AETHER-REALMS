<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOCIAL CREATORS | 1M PIXEL ARCHIVE</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <style>
        :root { --binance-gold: #F3BA2F; --bg: #f0f0f0; }
        body { margin: 0; background: var(--bg); font-family: Arial, Helvetica, sans-serif; overflow-x: hidden; }

        /* Navigation - Unchanged structure */
        .top-nav { position: fixed; top: 0; width: 100%; padding: 10px 30px; display: flex; justify-content: space-between; align-items: center; z-index: 1000; background: #fff; border-bottom: 2px solid #000; box-sizing: border-box; }
        .nav-left { display: flex; gap: 10px; align-items: center; }
        .nav-btn { background: #eee; border: 1px solid #ccc; color: #000; padding: 8px 15px; font-size: 11px; font-weight: bold; cursor: pointer; text-transform: uppercase; }
        .nav-btn:hover { background: #000; color: #fff; }
        .buy-btn { background: var(--binance-gold) !important; border: 1px solid #000 !important; color: #000 !important; }

        .counter-box { text-align: right; font-family: 'Courier New', monospace; font-size: 12px; font-weight: bold; }

        /* Binance Style Title */
        .header-main { text-align: center; padding: 80px 0 20px 0; background: #fff; }
        .site-title { 
            font-size: 45px; font-weight: 900; letter-spacing: -1px; margin: 0; 
            text-transform: uppercase; 
            background: linear-gradient(135deg, #000000 0%, #F3BA2F 50%, #000000 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }

        /* Canvas - Million Dollar Homepage Style */
        .canvas-container { position: relative; width: 1050px; margin: 20px auto; background: #fff; border: 2px solid #000; padding: 25px; box-shadow: 10px 10px 0 rgba(0,0,0,0.05); }
        .grid-label-v { position: absolute; left: 5px; top: 25px; height: 1000px; display: flex; flex-direction: column; justify-content: space-between; font-size: 9px; color: #888; }
        .grid-label-h { position: absolute; top: 5px; left: 25px; width: 1000px; display: flex; justify-content: space-between; font-size: 9px; color: #888; }
        #pixel-canvas { width: 1000px; height: 1000px; background: #fff; border: 1px solid #ddd; position: relative; background-image: linear-gradient(#f0f0f0 1px, transparent 1px), linear-gradient(90deg, #f0f0f0 1px, transparent 1px); background-size: 10px 10px; }

        /* Support Icon Moved Down */
        .support-icon { position: fixed; bottom: 30px; left: 30px; background: #000; color: #fff; width: 50px; height: 50px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; border: 2px solid var(--binance-gold); z-index: 2000; }

        /* Modals */
        .modal { position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); display:none; align-items:center; justify-content:center; z-index:9999; }
        .card { background: #fff; padding: 35px; width: 450px; border: 5px solid #000; text-align: center; box-shadow: 10px 10px 0 var(--binance-gold); }
        .buy-input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #000; font-size: 16px; text-align: center; box-sizing: border-box; }
        .premium-btn { background: #000; color: #fff; width: 100%; padding: 15px; border: none; font-weight: bold; cursor: pointer; text-transform: uppercase; margin-top: 10px; }
        .info-list { text-align: left; background: #f4f4f4; padding: 15px; margin: 15px 0; font-size: 13px; line-height: 1.6; border-left: 4px solid var(--binance-gold); }
    </style>
</head>
<body>

    <div class="top-nav">
        <div class="nav-left">
            <button class="nav-btn" onclick="downloadMap()">Download Map</button>
            <button class="nav-btn" onclick="location.href='index.html'">Back Home</button>
            <button class="nav-btn" onclick="openModal('pay-modal')">Payment Gateway</button>
            <button class="nav-btn buy-btn" onclick="openModal('order-modal')">Buy Plots</button>
        </div>
        <div class="counter-box">Plots: 100,000 | Pixels: 1,000,000</div>
    </div>

    <div class="header-main">
        <h1 class="site-title">Social Creators</h1>
    </div>

    <div class="canvas-container" id="capture-area">
        <div class="grid-label-h"><span>0</span><span>100</span><span>200</span><span>300</span><span>400</span><span>500</span><span>600</span><span>700</span><span>800</span><span>900</span><span>1000</span></div>
        <div class="grid-label-v"><span>0</span><span>100</span><span>200</span><span>300</span><span>400</span><span>500</span><span>600</span><span>700</span><span>800</span><span>900</span><span>1000</span></div>
        <div id="pixel-canvas"></div>
    </div>

    <div id="order-modal" class="modal">
        <div class="card">
            <h3>SUBMIT REQUEST</h3>
            <input type="text" id="brand-name" class="buy-input" placeholder="Enter Brand Name">
            <input type="number" id="plot-qty" class="buy-input" value="10" min="10">
            <p id="total-price" style="font-weight:bold;">Total: $100</p>
            <button class="premium-btn" onclick="submitToAdmin()">SUBMIT REQUEST</button>
            <p onclick="closeModals()" style="cursor:pointer; font-size:10px; text-decoration:underline; margin-top:10px;">CANCEL</p>
        </div>
    </div>

    <div id="success-modal" class="modal">
        <div class="card" style="border-color: green;">
            <h2 style="color: green;">CONGRATULATIONS!</h2>
            <p>Your request has been successfully submitted to the admin panel.</p>
        </div>
    </div>

    <div id="support-modal" class="modal">
        <div class="card">
            <h3>WHAT TO DO NEXT?</h3>
            <div class="info-list">
                - ✅ Send Payment Screenshot<br>
                - ✅ Send Brand Logo (PNG)<br>
                - ✅ Send Target Website Link<br>
                - ✅ Plot Quantity: <span id="final-qty">0</span>
            </div>
            <button class="premium-btn" id="wa-final-btn">CONTACT SUPPORT</button>
            <button class="premium-btn" style="background:#888;" onclick="closeModals()">BACK TO CANVAS</button>
        </div>
    </div>

    <div id="pay-modal" class="modal">
        <div class="card">
            <h3>PAYMENT GATEWAY</h3>
            <div style="text-align:left; font-size:12px; line-height:2;">
                <b>Metamask:</b> <span onclick="navigator.clipboard.writeText(this.innerText); alert('Copied')">0x443792A4884e8e855f954ccEF910778Aff1eb78E</span><br>
                <b>Binance UID:</b> <span onclick="navigator.clipboard.writeText(this.innerText); alert('Copied')">912221034</span><br>
                <b>USDT (TRC20):</b> <span onclick="navigator.clipboard.writeText(this.innerText); alert('Copied')">TTapBkTqrDnzHbWzek6wSBUTcJKFmR8Ws6</span>
            </div>
            <button class="premium-btn" onclick="closeModals()">CLOSE</button>
        </div>
    </div>

    <div class="support-icon" onclick="window.open('https://wa.me/8801576940717')">
        <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2C6.477 2 2 6.477 2 12c0 1.891.527 3.66 1.438 5.168L2.05 22l4.986-1.308A9.957 9.957 0 0 0 12 22c5.523 0 10-4.477 10-10S17.523 2 12 2zm0 18c-1.731 0-3.355-.487-4.736-1.332l-.339-.207-2.958.776.79-2.883-.228-.363A7.955 7.955 0 0 1 4 12c0-4.411 3.589-8 8-8s8 3.589 8 8-3.589 8-8 8z"/></svg>
    </div>

    <script type="module">
        import { db, ref, push, serverTimestamp } from "./firebase-config.js";

        window.openModal = (id) => document.getElementById(id).style.display = 'flex';
        window.closeModals = () => document.querySelectorAll('.modal').forEach(m => m.style.display = 'none');

        document.getElementById('plot-qty').oninput = function() {
            document.getElementById('total-price').innerText = `Total: $${this.value * 10}`;
        };

        window.submitToAdmin = async () => {
            const brand = document.getElementById('brand-name').value;
            const qty = document.getElementById('plot-qty').value;
            if(!brand) return alert("Enter brand name!");

            try {
                // Admin Panel এ ডাটা পাঠানো
                await push(ref(db, 'requests/SocialCreators'), { brand, quantity: qty, timestamp: serverTimestamp() });
                
                // অভিনন্দন ও কনফেটি
                document.getElementById('order-modal').style.display = 'none';
                document.getElementById('success-modal').style.display = 'flex';
                confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });

                // ৩ সেকেন্ড পর অটো ইন্সট্রাকশন পপ-আপ
                setTimeout(() => {
                    document.getElementById('success-modal').style.display = 'none';
                    document.getElementById('support-modal').style.display = 'flex';
                    document.getElementById('final-qty').innerText = qty;
                    
                    const msg = encodeURIComponent(`Hi K ARCHIVE Support,\nI want to buy ${qty} plots for "${brand}". Request submitted.`);
                    document.getElementById('wa-final-btn').onclick = () => window.open(`https://wa.me/8801576940717?text=${msg}`);
                }, 3000);

            } catch (e) { console.error(e); alert("Connection error. Check firebase-config."); }
        };
    </script>
</body>
</html>
