<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MASTER ADMIN | MILLIONAIRES CLUB</title>
    <style>
        :root { --gold: #FCD535; --bg: #0B0E11; --card: #1E2329; }
        body { font-family: sans-serif; background: var(--bg); color: #fff; padding: 20px; display: none; }
        .container { max-width: 1200px; margin: 0 auto; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .card { background: var(--card); padding: 20px; border-radius: 10px; border: 1px solid #333; margin-bottom: 20px; }
        h2 { color: var(--gold); text-transform: uppercase; font-size: 18px; border-bottom: 1px solid #333; padding-bottom: 10px; }
        input { padding: 12px; width: 100%; margin-bottom: 10px; border: 1px solid #444; background: #0B0E11; color: #fff; border-radius: 4px; box-sizing: border-box; }
        button { padding: 10px 20px; cursor: pointer; border-radius: 5px; border: none; font-weight: bold; transition: 0.3s; }
        .btn-approve { background: #2ebd85; color: white; width: 100%; }
        .btn-reject { background: #f6465d; color: white; margin-top: 5px; width: 100%; }
        .btn-manual { background: var(--gold); color: #000; width: 100%; margin-top: 10px; }
        .item { padding: 12px; background: #000; border-bottom: 1px solid #333; display: flex; justify-content: space-between; align-items: center; font-size: 14px; }
        .btn-delete { background: #f6465d; color: white; padding: 5px 10px; font-size: 11px; }
        .scroll { height: 400px; overflow-y: auto; }
    </style>
</head>
<body>
    <script>
        // আপনার পাসওয়ার্ড চেক
        if(prompt("Master Access Password:") === "zoomlink34@gmail.com") { 
            document.body.style.display = "block"; 
        } else { 
            window.location.href = "index.html"; 
        }
    </script>

    <div class="container">
        <h1 style="text-align: center; color: var(--gold); letter-spacing: 3px;">MILLIONAIRE COMMAND CENTER</h1>
        
        <div class="grid">
            <div class="card">
                <h2>Pending Requests (Customer Orders)</h2>
                <div id="order-list" class="scroll">Loading...</div>
            </div>

            <div class="right-col">
                <div class="card">
                    <h2>Manual Direct Update</h2>
                    <input type="number" id="mPlot" placeholder="Plot ID (1-100)">
                    <input type="text" id="mBrand" placeholder="Customer Name/Brand">
                    <input type="text" id="mImg" placeholder="Logo Link (Image URL)">
                    <input type="text" id="mWeb" placeholder="Social/Website Link">
                    <button class="btn-manual" onclick="manualUpdate()">UPDATE & GO LIVE</button>
                </div>

                <div class="card">
                    <h2>Live Records (Clear Plots)</h2>
                    <div id="liveRecords" class="scroll">Loading...</div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCAdnfu2R82xbC7H85n_9mvQBE58X3TjbA",
            authDomain: "the-5k-elite-legacy.firebaseapp.com",
            databaseURL: "https://the-5k-elite-legacy-default-rtdb.firebaseio.com",
            projectId: "the-5k-elite-legacy",
            appId: "1:440824313752:web:2c93344dcfe2ba0a4c5ded"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // ১. কাস্টমার অর্ডার লোড করা
        db.ref('pending_orders/Millionaire').on('value', s => {
            const list = document.getElementById('order-list');
            list.innerHTML = "";
            const data = s.val();
            if(!data) return list.innerHTML = "<p style='color:#666'>No pending orders.</p>";
            
            Object.keys(data).forEach(key => {
                const order = data[key];
                list.innerHTML += `
                    <div class="card" style="border-left: 5px solid var(--gold); background: #111;">
                        <b>PLOT #${order.plotID}</b> | USER: ${order.brandName} <br><br>
                        <input type="text" id="img_${key}" placeholder="Paste Logo URL">
                        <input type="text" id="web_${key}" placeholder="Paste Social Link">
                        <button class="btn-approve" onclick="approve('${key}', '${order.plotID}', '${order.brandName}')">APPROVE & LIVE</button>
                        <button class="btn-reject" onclick="reject('${key}')">DELETE REQUEST</button>
                    </div>`;
            });
        });

        // এপ্রুভ ফাংশন (ম্যাপে লাইভ করবে)
        function approve(key, pid, brand) {
            const img = document.getElementById('img_'+key).value;
            const web = document.getElementById('web_'+key).value;
            if(!img) return alert("Logo URL missing!");

            db.ref('sold_plots/plot_'+pid).set({
                plotID: pid, 
                username: brand, 
                image: img, 
                social: web || "#"
            }).then(() => {
                db.ref('pending_orders/Millionaire/'+key).remove();
                alert("Plot #" + pid + " is now LIVE!");
            });
        }

        // রিজেক্ট ফাংশন
        function reject(key) {
            if(confirm("Reject this order?")) db.ref('pending_orders/Millionaire/'+key).remove();
        }

        // ২. ম্যানুয়াল ডিরেক্ট আপডেট
        function manualUpdate() {
            const pid = document.getElementById('mPlot').value;
            const name = document.getElementById('mBrand').value;
            const img = document.getElementById('mImg').value;
            const web = document.getElementById('mWeb').value;
            if(!pid || !name || !img) return alert("Fill all fields!");

            db.ref('sold_plots/plot_'+pid).set({
                plotID: pid, username: name, image: img, social: web || "#"
            }).then(() => alert("Manual Live Success!"));
        }

        // ৩. লাইভ রেকর্ড থেকে ডিলিট
        db.ref('sold_plots').on('value', s => {
            const list = document.getElementById('liveRecords'); list.innerHTML = "";
            const data = s.val(); if(!data) return list.innerHTML = "No live records.";
            Object.keys(data).forEach(key => {
                const item = data[key];
                list.innerHTML += `<div class="item">
                    <span>#${item.plotID} - ${item.username}</span>
                    <button class="btn-delete" onclick="clearPlot('${key}')">REMOVE</button>
                </div>`;
            });
        });

        function clearPlot(key) {
            if(confirm("Remove this brand from map?")) db.ref('sold_plots/'+key).remove();
        }
    </script>
</body>
</html>
