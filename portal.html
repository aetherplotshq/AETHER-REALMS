<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K ARCHIVE | SECURE ACCESS</title>
    <style>
        :root { 
            --black: #000000; 
            --gold: #FCD535; 
            --white: #ffffff;
        }

        body { 
            margin: 0; 
            font-family: 'Courier New', Courier, monospace; 
            background: var(--white); 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            min-height: 100vh;
            padding: 20px;
        }

        .portal-card { 
            width: 100%; 
            max-width: 380px; 
            border: 3px solid var(--black); 
            padding: 40px 30px; 
            background: #fff; 
            box-shadow: 15px 15px 0px var(--black);
            text-align: center;
        }

        /* Minecraft Style Logo */
        .mc-logo {
            width: 80px; height: 80px; background: var(--black); color: var(--gold);
            display: flex; align-items: center; justify-content: center;
            font-size: 45px; font-weight: bold; margin: 0 auto 25px;
            border: 4px solid var(--gold); image-rendering: pixelated;
            text-transform: uppercase;
        }

        h2 { font-size: 18px; letter-spacing: 4px; margin-bottom: 30px; text-transform: uppercase; }

        input, select { 
            width: 100%; padding: 12px; margin-bottom: 15px; 
            border: 2px solid var(--black); box-sizing: border-box; 
            font-family: inherit; outline: none; font-size: 13px;
        }

        .btn-action { 
            width: 100%; padding: 15px; background: var(--black); color: var(--white); 
            border: none; font-weight: bold; cursor: pointer; 
            letter-spacing: 2px; text-transform: uppercase; transition: 0.3s;
        }
        .btn-action:hover { background: var(--gold); color: var(--black); }

        .view-section { display: none; }
        .view-section.active { display: block; }

        .logout-link { margin-top: 20px; display: block; font-size: 10px; color: red; cursor: pointer; text-decoration: underline; }
    </style>
</head>
<body>

    <div class="portal-card">
        <div id="reg-view" class="view-section active">
            <div class="mc-logo" id="preview-logo">?</div>
            <h2>Estate Sign Up</h2>
            
            <input type="text" id="reg-name" placeholder="FULL NAME">
            <input type="email" id="reg-email" placeholder="EMAIL ADDRESS" oninput="updateLogo(this.value)">
            <input type="password" id="reg-pass" placeholder="PASSWORD">
            
            <select id="reg-cat">
                <option value="MILLIONAIRE">MILLIONAIRE CLUB</option>
                <option value="CREATOR">SOCIAL CREATOR</option>
                <option value="GAMER">GAMING REALM</option>
                <option value="CITIZEN">STANDARD CITIZEN</option>
            </select>

            <button class="btn-action" onclick="processRegistration()">Create & Download Key</button>
        </div>

        <div id="profile-view" class="view-section">
            <div class="mc-logo" id="user-logo">?</div>
            <h2 id="disp-name" style="margin-bottom: 5px;">USER NAME</h2>
            <p id="disp-email" style="font-size: 12px; color: #666; margin-bottom: 25px;">email@example.com</p>
            
            <div style="text-align: left; font-size: 11px; border-top: 1px solid #eee; padding-top: 15px;">
                <p><b>RANK:</b> <span id="disp-cat">CITIZEN</span></p>
                <p><b>STATUS:</b> <span style="color: #008000;">VERIFIED MEMBER</span></p>
            </div>

            <button class="btn-action" style="margin-top: 20px;" onclick="window.location.href='index.html'">Enter Archive</button>
            <span class="logout-link" onclick="handleLogout()">[ LOGOUT ]</span>
        </div>
    </div>

    <script>
        // ইমেইলের প্রথম অক্ষর লোগোতে দেখানো
        function updateLogo(val) {
            const logo = document.getElementById('preview-logo');
            logo.innerText = val ? val.charAt(0) : "?";
        }

        function processRegistration() {
            const name = document.getElementById('reg-name').value;
            const email = document.getElementById('reg-email').value;
            const pass = document.getElementById('reg-pass').value;
            const cat = document.getElementById('reg-cat').value;

            if(!name || !email || !pass) {
                alert("Please fill all fields to secure your estate.");
                return;
            }

            // *** অটোমেটিক ডাউনলোড সিস্টেম ***
            const fileContent = `K ARCHIVE - ACCESS KEY\n----------------------\nNAME: ${name}\nEMAIL: ${email}\nPASSWORD: ${pass}\nCATEGORY: ${cat}\nJOIN DATE: ${new Date().toLocaleString()}\n----------------------\nKEEP THIS FILE SAFE.`;
            const blob = new Blob([fileContent], { type: 'text/plain' });
            const tempLink = document.createElement('a');
            tempLink.href = URL.createObjectURL(blob);
            tempLink.download = `K_Archive_Key_${name}.txt`;
            tempLink.click();

            // লোকাল স্টোরেজে ডাটা সেভ করা (লগইন স্ট্যাটাস রাখার জন্য)
            const userData = { name, email, cat };
            localStorage.setItem('kUser', JSON.stringify(userData));

            // সরাসরি মেইন সাইটে পাঠিয়ে দেওয়া
            window.location.href = 'index.html';
        }

        function checkAuth() {
            const savedUser = localStorage.getItem('kUser');
            if (savedUser) {
                const user = JSON.parse(savedUser);
                document.getElementById('reg-view').classList.remove('active');
                document.getElementById('profile-view').classList.add('active');
                
                document.getElementById('disp-name').innerText = user.name;
                document.getElementById('disp-email').innerText = user.email;
                document.getElementById('disp-cat').innerText = user.cat;
                document.getElementById('user-logo').innerText = user.email.charAt(0);
            }
        }

        function handleLogout() {
            localStorage.removeItem('kUser');
            location.reload();
        }

        // পেজ লোড হলে চেক করা
        window.onload = checkAuth;
    </script>
</body>
</html>
