<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"><title>CLAIM ASSET</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
</head>
<body>
<div id="oForm" style="max-width:480px; margin:80px auto; background:#050505; padding:45px; border:2px solid gold; text-align:center;">
    <h2 style="color:gold; font-family:'Cinzel Decorative';">CLAIM PLOT <span id="pId"></span></h2>
    <input type="text" id="custName" placeholder="ENTER YOUR NAME" style="width:90%; padding:15px; margin:25px 0; background:#000; border:1px solid gold; color:white; text-align:center;">
    <button class="nav-btn" style="width:100%; height:50px; background:gold; color:black; font-weight:bold;" onclick="submitOrder()">ACTIVATE NOW</button>
</div>

<div id="success" style="display:none; text-align:center; padding-top:120px;">
    <h1 style="color:gold;">ORDER SUBMITTED!</h1>
    <p>Contact Support with your Screenshot.</p>
    <button class="nav-btn" onclick="location.href='index.html'">GO HOME</button>
</div>

<script type="module">
    import { db, ref, push, serverTimestamp } from "./firebase-config.js";
    const id = new URLSearchParams(window.location.search).get('id');
    document.getElementById('pId').innerText = id;

    window.submitOrder = () => {
        const name = document.getElementById('custName').value;
        if(!name) return alert("Enter Name!");

        push(ref(db, 'orders'), {
            customerName: name,
            plotId: id,
            time: serverTimestamp(),
            status: "pending"
        }).then(() => {
            localStorage.setItem('hasPlot','true');
            localStorage.setItem('uName', name);
            document.getElementById('oForm').style.display='none';
            document.getElementById('success').style.display='block';
            confetti({ particleCount: 300, spread: 100 });
        });
    }
</script>
</body>
</html>
