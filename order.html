<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ACQUIRE ASSET</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
</head>
<body>

<div id="oForm" style="max-width:480px; margin:60px auto; background:#050505; padding:45px; border:2px solid gold; border-radius:12px; text-align:center; box-shadow: 0 0 30px rgba(255, 215, 0, 0.2);">
    <h2 style="color:gold; font-family:'Cinzel Decorative'; letter-spacing: 3px;">CLAIM YOUR TERRITORY</h2>
    
    <div style="background:#111; padding:10px; border:1px dashed gold; margin-bottom:20px;">
        <span style="color:grey; font-size:12px;">SELECTED PLOT</span><br>
        <b id="displayPlotId" style="color:gold; font-size:20px;">#00</b>
    </div>

    <input type="text" id="custName" placeholder="ENTER YOUR GAMING NAME" style="width:90%; padding:15px; margin-bottom:20px; background:#000; border:1px solid gold; color:white; font-family:sans-serif; outline:none; text-align:center;">
    
    <button class="nav-btn" style="width:100%; background:gold; color:black; font-weight:bold; height:50px; cursor:pointer; font-size:18px;" onclick="submitToFirebase()">ACTIVATE & CLAIM</button>
    
    <p style="color:grey; font-size:12px; margin-top:15px;">* Information will be sent to the Captain's Log</p>
</div>

<div id="success" style="display:none; text-align:center; padding-top:100px;">
    <div style="font-size:100px; animation: breathe 2s infinite;">ðŸ”¥</div>
    <h1 style="color:gold; font-family:'Cinzel Decorative'; font-size:40px;">REGISTRATION COMPLETE!</h1>
    <p style="color:white; font-size:18px;">Your request for Plot <span id="finalId" style="color:gold;"></span> has been sent.</p>
    <p style="opacity:0.6;">Contact support on WhatsApp to go live.</p>
    
    <div style="margin-top:30px;">
        <button class="nav-btn" onclick="location.href='index.html'" style="margin:10px;">BACK TO HOME</button>
        <button class="nav-btn" onclick="window.open('https://wa.me/8801576940717')" style="background:#25D366; border:none; color:white;">WHATSAPP NOW</button>
    </div>
</div>

<script type="module">
    // Firebase Setup
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js";
    import { getDatabase, ref, push, set } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-database.js";

    const firebaseConfig = {
        apiKey: "AIzaSyDmMgjlpXsk0Ip5Frrlifu6bgRJNNIIYzM",
        authDomain: "aether-realms.firebaseapp.com",
        databaseURL: "https://aether-realms-default-rtdb.firebaseio.com",
        projectId: "aether-realms",
        storageBucket: "aether-realms.firebasestorage.app",
        messagingSenderId: "745970771566",
        appId: "1:745970771566:web:1b0607362279665074a87f"
    };
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // à§§. à¦‡à¦‰à¦†à¦°à¦à¦² à¦¥à§‡à¦•à§‡ à¦ªà§à¦²à¦Ÿ à¦†à¦‡à¦¡à¦¿ à¦¨à§‡à¦“à§Ÿà¦¾
    const urlParams = new URLSearchParams(window.location.search);
    const plotId = urlParams.get('id') || "None";
    document.getElementById('displayPlotId').innerText = plotId;
    document.getElementById('finalId').innerText = plotId;

    // à§¨. à¦¡à¦¾à¦Ÿà¦¾ à¦¸à¦¾à¦¬à¦®à¦¿à¦Ÿ à¦«à¦¾à¦‚à¦¶à¦¨
    window.submitToFirebase = function() {
        const name = document.getElementById('custName').value;
        if(!name) return alert("Please enter your name, Captain!");

        // à¦«à¦¾à§Ÿà¦¾à¦°à¦¬à§‡à¦¸à§‡ 'orders' à¦²à¦¿à¦¸à§à¦Ÿà§‡ à¦¸à§‡à¦­ à¦•à¦°à¦¾ à¦¹à¦šà§à¦›à§‡
        const orderRef = ref(db, 'orders');
        push(orderRef, {
            customerName: name,
            plotId: plotId,
            time: new Date().toLocaleString(),
            status: "pending"
        }).then(() => {
            // à¦¸à§‡à¦­ à¦¹à§Ÿà§‡ à¦—à§‡à¦²à§‡ à¦à¦¨à¦¿à¦®à§‡à¦¶à¦¨ à¦¦à§‡à¦–à¦¾à¦¨à§‹
            document.getElementById('oForm').style.display='none';
            document.getElementById('success').style.display='block';
            
            // à¦—à§‡à¦®à¦¿à¦‚ à¦—à§‹à¦²à§à¦¡à§‡à¦¨ à¦•à¦¨à¦«à§‡à¦Ÿà¦¿ à¦‡à¦«à§‡à¦•à§à¦Ÿ
            confetti({
                particleCount: 400,
                spread: 120,
                origin: { y: 0.6 },
                colors: ['#FFD700', '#FFA500', '#FFFFFF']
            });
            
            // à¦²à§‹à¦•à¦¾à¦² à¦¸à§à¦Ÿà§‹à¦°à§‡à¦œà§‡ à¦¸à§‡à¦­ (à¦¯à¦¾à¦¤à§‡ à¦šà§à¦¯à¦¾à¦Ÿ à¦†à¦¨à¦²à¦• à¦¹à§Ÿ à¦ªà¦°à§‡)
            localStorage.setItem('uName', name);
            localStorage.setItem('myPlotId', plotId);
        }).catch((error) => {
            alert("Connection Lost! Try again.");
        });
    }
</script>
</body>
</html>
